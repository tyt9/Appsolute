<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.solution.appsolute.approval.dao.ApprovalDao">

    <resultMap id="deptResultMap" type="com.solution.appsolute.approval.dto.Dept">
        <result property="deptNo" column="dept_no"/>
        <result property="deptName" column="dept_name"/>
        <result property="deptBranch" column="dept_branch"/>
        <result property="deptLoc" column="dept_loc"/>
    </resultMap>

    <resultMap id="empResultMap" type="com.solution.appsolute.approval.dto.Employee">
        <result property="empNum" column="emp_num"/>
        <result property="deptNo" column="dept_no"/>
        <result property="empEmail" column="emp_email"/>
        <result property="empHireDate" column="emp_hire_date"/>
        <result property="empLeader" column="emp_leader"/>
        <result property="empMgr" column="emp_mgr"/>
        <result property="empName" column="emp_name"/>
        <result property="empPassword" column="emp_password"/>
        <result property="empPhone" column="emp_phone"/>
        <result property="empPosition" column="emp_position"/>
    </resultMap>

    <resultMap id="documentResultMap" type="com.solution.appsolute.approval.dto.Document">
        <result property="documentNum" column="document_num"/>
        <result property="documentName" column="document_name"/>
    </resultMap>

    <select id="find" resultType="java.util.Map">
        select * from approval
    </select>

    <select id="deptList" resultMap="deptResultMap">
        select * from dept
    </select>

    <select id="empList" resultMap="empResultMap">
        select * from employee
    </select>

    <insert id="insertApp" parameterType="com.solution.appsolute.approval.dto.Basic">
        <selectKey keyProperty="approvalNum" resultType="java.lang.Long" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
        insert into approval values
        (null, 0, #{approvalDate} , 1, 0, #{title},#{documentNum}, #{empNum}, #{lineNum}, now(), #{creationDate})
    </insert>

    <insert id="addPerson" parameterType="com.solution.appsolute.approval.dto.AddPersonVO">
        insert into approval_detail values
        (null, #{empCheckNum}, #{sequence}, null, 0, #{approvalNum}, 0, null)
    </insert>

    <insert id="addDetail" parameterType="com.solution.appsolute.approval.dto.AddDetailVO">
        insert into approval_content_detail values
            (null, #{approvalNum}, #{documentNum}, #{documentNum}, #{documentNum}) // VO 구성 잘못했내요...
    </insert>









</mapper>
