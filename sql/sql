create database APPSOLUTE;

create user 'APPSOLUTE'@'localhost' identified by 'APPSOLUTE';
grant all privileges on APPSOLUTE.* to 'APPSOLUTE'@'localhost';

create user 'APPSOLUTE'@'%' identified by 'APPSOLUTE';
grant all privileges on APPSOLUTE.* to 'APPSOLUTE'@'%';

CREATE TABLE DEPT(
	DEPTNO INT PRIMARY KEY,
    DEPTNAME VARCHAR(20) NOT NULL,
    DEPTLOC VARCHAR(30) NOT NULL,
    DEPTBRANCH INT NOT NULL DEFAULT 0
);

CREATE TABLE EMPLOYEE(
	EMPNUM INT auto_increment PRIMARY KEY,
    EMPNAME VARCHAR(30) NOT NULL,
    DEPTNO INT NOT NULL,
    EMPPHONE VARCHAR(50) NOT NULL,
    EMPEMAIL VARCHAR(100) NOT NULL,
    EMPPASSWORD VARCHAR(50) NOT NULL,
    EMPHIREDATE TIMESTAMP NOT NULL,
    EMPPOSITION VARCHAR(20) NOT NULL,
    EMPLEADER INT NOT NULL DEFAULT 0,
    EMPMGR INT ,
    FOREIGN KEY(DEPTNO) REFERENCES DEPT(DEPTNO)
);

    CREATE TABLE notice (
    noNum INT AUTO_INCREMENT PRIMARY KEY,
    noTitle VARCHAR(255) NOT NULL,
    noContent VARCHAR(1000) NOT NULL,
    EMPNUM INT NOT NULL,
    noRegdate TIMESTAMP NOT NULL,
    noHits INT DEFAULT 0,
    noImp INT DEFAULT 0,
    FOREIGN KEY (EMPNUM) REFERENCES employee(EMPNUM)
);

CREATE TABLE REPLY (
    RENum INT AUTO_INCREMENT PRIMARY KEY,
    noNum int NOT NULL,
    REContent VARCHAR(1000) NOT NULL,
    RERegdate TIMESTAMP NOT NULL,
    EMPNUM INT NOT NULL,
    FOREIGN KEY (NONUM) REFERENCES NOTICE(NONUM),
    FOREIGN KEY (EMPNUM) REFERENCES employee (empNum)
);
create table mail (
   mailNum INT AUTO_INCREMENT PRIMARY KEY,
    mailTitle varchar(100) not null,
    mailContent varchar(500) not null,
    mailDate TIMESTAMP,
    MAILsender int not null,
    MAILreciver int not null,
    MAILCheck int default 0,
    FOREIGN KEY (MAILsender) REFERENCES employee (empNum),
    FOREIGN KEY (MAILreciver) REFERENCES employee (empNum)
    );

CREATE TABLE APPROVAL(
	APPROVALNUM INT AUTO_INCREMENT PRIMARY KEY,
    EMPNUM INT NOT NULL,
    APPCONTENT VARCHAR(1000) NOT NULL,
    APPTITLE VARCHAR(500) NOT NULL,
    APPCHECK INT DEFAULT 0,
    LINENUM INT,
    DOCUMENTNUM INT,
    APPDEL INT DEFAULT 0,
    FOREIGN KEY (EMPNUM) REFERENCES EMPLOYEE(EMPNUM),
	FOREIGN KEY(DOCUMENTNUM) REFERENCES DOCUMENT(DOCUMENTNUM)
);

 CREATE TABLE APPROVALDETAIL(
	APPROVALDETAILNUM INT auto_increment PRIMARY KEY,
    EMPCHECKNUM INT NOT NULL,
    APPROVALLINENUM INT,
    APPROVALSTATUS INT DEFAULT 0,
    APPROVALDATE TIMESTAMP NOT NULL,
    REJECTREASON VARCHAR(500) ,
    APPDETAILSEQ INT NOT NULL,
    APPROVALNUM INT NOT NULL,
	FOREIGN KEY (EMPCHECKNUM) REFERENCES EMPLOYEE(EMPNUM),
    FOREIGN KEY(APPROVALLINENUM) REFERENCES APPROVALLINE(LINENUM),
    FOREIGN KEY(APPROVALNUM) REFERENCES APPROVAL(APPROVALNUM)
);

CREATE TABLE APPROVALLINE(
	LINENUM INT AUTO_INCREMENT PRIMARY KEY,
    EMPNUM INT NOT NULL,
    LINENAME VARCHAR(50) NOT NULL,
    LINEDEL INT DEFAULT 0,
    FOREIGN KEY (EMPNUM) REFERENCES EMPLOYEE(EMPNUM)
);

CREATE TABLE APPROVALLINEDETAIL (
	LINEDETAILNUM INT AUTO_INCREMENT PRIMARY KEY,
    LINENUM INT NOT NULL,
    EMPCHECKNUM INT,
    LINEDETAILSEQ INT ,
    FOREIGN KEY (LINENUM) REFERENCES APPROVALLINE(LINENUM),
    FOREIGN KEY (EMPCHECKNUM) REFERENCES EMPLOYEE(EMPNUM)
);

CREATE TABLE DOCUMENT(
	DOCUMENTNUM INT AUTO_INCREMENT PRIMARY KEY,
    DOCUMENTNAME VARCHAR(100) NOT NULL
);

INSERT INTO DEPT (DEPTNO, DEPTNAME, DEPTLOC, DEPTBRANCH)
VALUES
  (1, 'HR Department', 'New York', 0),
  (2, 'Sales Department', 'Los Angeles', 0),
  (3, 'Finance Department', 'Chicago', 0);

INSERT INTO EMPLOYEE (EMPNUM, EMPNAME, DEPTNO, EMPPHONE, EMPEMAIL, EMPPASSWORD, EMPHIREDATE, EMPPOSITION, EMPLEADER, EMPMGR)
VALUES
  (1, 'John Doe', 1, '555-123-4567', 'john@example.com', 'password123', '2023-01-15', 'Manager', 0, NULL),
  (2, 'Alice Smith', 2, '555-987-6543', 'alice@example.com', 'password456', '2023-02-20', 'Sales Associate', 1, 1),
  (3, 'Bob Johnson', 1, '555-789-0123', 'bob@example.com', 'password789', '2023-03-10', 'HR Specialist', 0, 1);

INSERT INTO APPROVAL (EMPNUM, APPCONTENT, APPTITLE, APPCHECK, LINENUM, DOCUMENTNUM, APPDEL)
VALUES
  (1, 'Approval content 1', 'Title 1', 0, 1, 1, 0),
  (2, 'Approval content 2', 'Title 2', 0, 2, 2, 0),
  (3, 'Approval content 3', 'Title 3', 0, 3, 1, 0);

INSERT INTO APPROVALLINE (EMPNUM, LINENAME, LINEDEL)
VALUES
  (1, 'Manager', 0),
  (2, 'Sales Manager', 0),
  (3, 'HR Manager', 0);

INSERT INTO APPROVALLINEDETAIL (LINENUM, EMPCHECKNUM, LINEDETAILSEQ)
VALUES
  (1, 2, 1),
  (2, 3, 2),
  (3, 1, 1);

INSERT INTO DOCUMENT (DOCUMENTNUM, DOCUMENTNAME)
VALUES
  (1, 'Document 1'),
  (2, 'Document 2');

INSERT INTO DOCUMENTDETAIL (DOCUMENTNUM, FIELDNAME, SEQUENCE, FORMAT)
VALUES
  (1, 'Field 1', 1, 0),
  (1, 'Field 2', 2, 1),
  (2, 'Field 1', 1, 0);

INSERT INTO APPROVALCONTENTDETAIL (APPROVALNUM, DOCUMENTNUM, KEY1, VALUE1, KEY2, VALUE2)
VALUES
  (1, 1, 'Key 1', 'Value 1', 'Key 2', 'Value 2'),
  (2, 2, 'Key A', 'Value A', 'Key B', 'Value B');
